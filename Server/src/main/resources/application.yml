server:
  port: 8080
  servlet:
    context-path: /api

spring:
  application:
    name: bookstore-server
  threads:
    virtual: true # 显式启用虚拟线程支持
  datasource:
    # 数据库连接配置
    # 配置优先级：环境变量 > 系统属性 > 默认值
    # 
    # 方式1：使用环境变量（推荐，最安全）
    #   Windows PowerShell: $env:DATABASE_URL="jdbc:postgresql://localhost:5432/bookstore"
    #   Windows CMD: set DATABASE_URL=jdbc:postgresql://localhost:5432/bookstore
    #   Linux/Mac: export DATABASE_URL="jdbc:postgresql://localhost:5432/bookstore"
    #
    # 方式2：修改 database.properties 文件
    #   编辑 Server/src/main/resources/database.properties
    #   然后使用系统属性：-Ddatabase.host=localhost -Ddatabase.username=postgres 等
    #
    # 方式3：直接修改下面的默认值（不推荐，会暴露密码）
    url: ${DATABASE_URL:jdbc:postgresql://localhost:5432/bookstore}
    username: ${DATABASE_USERNAME:postgres}
    password: ${DATABASE_PASSWORD:123456}
  jpa:
    hibernate:
      ddl-auto: update  # update: 自动更新表结构（如果表不存在则创建）
    show-sql: false
    properties:
      hibernate:
        format_sql: true  # 格式化SQL输出（当show-sql为true时）
  cache:
    type: caffeine

logging:
  level:
    root: INFO
    com.northgod.server: DEBUG
    org.springframework.boot.autoconfigure: DEBUG # 可查看虚拟线程启用日志
    org.hibernate.SQL: WARN
    org.hibernate.type.descriptor.sql.BasicBinder: WARN
  file:
    name: logs/bookstore-server.log
    max-size: 10MB
    max-history: 30
    total-size-cap: 300MB
  pattern:
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
